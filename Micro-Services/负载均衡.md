## 负载均衡

> Load Balance
>

### 目录
* [是什么？](#是什么？)
* [负载均衡的基本原理](#负载均衡的基本原理)
* [负载均衡技术](#负载均衡技术)

### 是什么？

负载均衡可以将工作任务分摊到多个处理单元，从而提高并发处理能力。

### 负载均衡的基本原理

任何的负载均衡技术都要想办法建立某种一对多的映射机制：一个请求的入口映射到多个处理请求的节点，从而实现分而治之（Divide and Conquer）。

这种映射机制使得多个物理存在对外体现为一个虚拟的整体，对服务的请求者屏蔽了内部的结构。

### 负载均衡技术

采用不同的机制建立映射关系，可以形成不同的负载均衡技术。常见的web负载均衡技术包括：DNS轮询、IP负载均衡和CDN。

* DNS轮询

    DNS轮询是最简单的负载均衡方式。以域名作为访问入口，通过配置多条DNS记录使得请求可以分配到不同的服务器。
    
    DNS轮询没有快速的健康检查机制，而且只支持WRR的调度策略导致负载很难“均衡”，通常用于要求不高的场景。并且DNS轮询方式直接将服务器的真实地址暴露给用户，不利于服务器安全。

* IP负载均衡

    IP负载均衡是基于特定的TCP/IP技术实现的负载均衡，比如NAT、DR、Turning等，是最经常使用的方式。
    
    IP负载均衡可以使用硬件设备，也可以使用软件实现。硬件设备的主要产品是F5-BIG-IP-GTM（简称F5)，软件产品主要有LVS、HAProxy、Nginx。其中LVS、HAProxy可以工作在4-7层，Nginx工作在7层。
    
    * F5 是最流行的硬件负载均衡设备，其并发能力达到百万级。
    
    * LVS(Linux Virtual Server, linux虚拟服务器） 基于不同的网络技术，LVS支持多种负载均衡机制。包括：VS/NAT（基于网络地址转换技术）、VS/TUN（基于IP隧道技术）和VS/DR（基于直接路由技术）。

* CDN

    CDN（Content Delivery Network，内容分发网络）。通过发布机制将内容同步到大量的缓存节点，并在DNS服务器上进行扩展，找到里用户最近的缓存节点作为服务提供节点。
    
    因为很难自建大量的缓存节点，所以通常使用CDN运营商的服务。目前国内的服务商很少，而且按流量计费，价格也比较昂贵。




